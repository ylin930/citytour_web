<!doctype html>
<html>
    <body>
        <h3>Storage private media test</h3>
        <video id="stim" width="480" controls></video>
        <pre id="log"></pre>

        <script type="module">
            import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
            import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
            import {
                getStorage,
                ref,
                getDownloadURL
            } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js";
            import { firebaseConfig } from "./js/firebase-config.js";

            const log = (m) => (document.getElementById("log").textContent += m + "\n");

            const app = initializeApp(firebaseConfig);
            const auth = getAuth(app);
            const storage = getStorage(app);

            try {
                // sign in anonymously first (your Storage rules require this)
                await signInAnonymously(auth);
                log("✅ Signed in anonymously.");

                // point to your uploaded video
                const path = "media/cover/CT_cover.mp4";
                const url = await getDownloadURL(ref(storage, path));
                log("✅ Got download URL.");

                // ⬇️ THIS is where it goes
                document.getElementById("stim").src = url;

                log("✅ Video loaded.");
            } catch (e) {
                log("❌ " + (e.message || e));
            }
        </script>
    </body>
</html>
